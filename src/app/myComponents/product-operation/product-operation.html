<table>
    <tr>
        <th>Id</th>
        <th>Ürün Adı</th>
        <th>Fiyat</th>
        <th>Stok</th>
        <th>Kategori ID</th>
        <th>İşlemler</th>
    </tr>

    @for(product of products();track product.id){
        <tr>
            <td>{{ product.id }}</td>
            <td>{{ product.productName }}</td>
            <td>{{ product.price }}</td>
            <td>{{ product.stock }}</td>
            <td>{{ product.categoryId }}</td>
            <td>
                <button (click)="startUpdate(product)"> Güncelle</button>
                <button (click)="onDelete(product.id)"> Sil</button>
            </td>
        </tr>
    }
</table>

<hr>

<form [formGroup]="createForm" (ngSubmit)="onCreate()">

    <h3>Ürün Ekle</h3>
    <label>Ürün Adı

        <input type="text" formControlName="name" />
    </label>
    @if(getErrorMessageByName(createForm,'name'); as msg){
        <div class="error">
            {{ msg }}
        </div>
    }

    <label>
        Fiyat
        <input type="number" formControlName="price" />
    </label>

    @if(getErrorMessageByName(createForm,'price'); as msg){
        <div class="error">
            {{ msg }}
        </div>
    }

    <label>
        Stok
        <input type="number" formControlName="stock" />
    </label>

    @if(getErrorMessageByName(createForm,'stock'); as msg){
        <div class="error">
            {{ msg }}
        </div>
    }

    <label>
        Kategori ID
        <input type="number" formControlName="categoryId" />
    </label>

    @if(getErrorMessageByName(createForm,'categoryId'); as msg){
        <div class="error">
            {{ msg }}
        </div>
    }

    <button type="submit" [disabled]="createForm.invalid">Ekle</button>

</form>

<hr>
@if(selectedProduct() !==null){
    <form [formGroup]="updateForm" (ngSubmit)="onUpdate()">
        <h3>Ürün Güncelle</h3>

        <input type="hidden" formControlName="id" />

        <label>
            Ürün Adı
            <input type="text" formControlName="name" />
        </label>
        @if(getErrorMessageByName(updateForm,'name'); as msg){
        <div class="error">
            {{ msg }}
        </div>
    }
    <label>
        Fiyat
    <input type="number" formControlName="price" />
    </label>
    @if(getErrorMessageByName(updateForm,'price'); as msg){
        <div class="error">
            {{ msg }}
        </div>
    }

    <label>
        Stok
    <input type="number" formControlName="stock" />
    </label>
    @if(getErrorMessageByName(updateForm,'stock'); as msg){
        <div class="error">
            {{ msg }}
        </div>
    }

    <label>
        Kategori ID
    <input type="number" formControlName="categoryId" />
    </label>
    @if(getErrorMessageByName(updateForm,'categoryId'); as msg){
        <div class="error">
            {{ msg }}
        </div>
    }

    <button type="submit" [disabled]="updateForm.invalid">Güncelle</button>

    <button type="button" (click)="cancelUpdate()">İptal</button>
    </form>
}
